# ç‹¼äººæ€ Agent è¯„ä¼°ç³»ç»Ÿä½¿ç”¨æŒ‡å—

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•ä½¿ç”¨è¯„ä¼°ç³»ç»Ÿæ¥é‡åŒ–å’Œå¯¹æ¯”ä¸åŒ Agent çš„æ€§èƒ½ã€‚

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è¯„ä¼°ç³»ç»Ÿå…è®¸ä½ ï¼š
- âœ… æ‰¹é‡è¿è¡Œå¤šå±€æ¸¸æˆï¼ˆ10 å±€ã€100 å±€ç­‰ï¼‰
- âœ… è®°å½•æ¯å±€æ¸¸æˆçš„è¯¦ç»†ç»“æœ
- âœ… ç»Ÿè®¡å’Œå¯¹æ¯”ä¸åŒ Agent çš„èƒœç‡
- âœ… ç”Ÿæˆè¯„ä¼°æŠ¥å‘Šï¼ˆæ–‡æœ¬/JSON æ ¼å¼ï¼‰

## ğŸ“‹ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡ŒåŸºçº¿æµ‹è¯•

é¦–å…ˆï¼Œè¿è¡ŒåŸºçº¿ Agentï¼ˆæ™®é€š ReActAgentï¼‰çš„æµ‹è¯•ï¼š

```bash
cd examples/game/werewolves
python evaluate.py --num-games 10 --mode baseline
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
==================================================
ç‹¼äººæ€æ¸¸æˆ Agent è¯„ä¼°ç³»ç»Ÿ
==================================================
æ¨¡å¼: baseline
æ¸¸æˆå±€æ•°: 10
è¾“å‡ºè·¯å¾„: evaluation_results_baseline_20250115_143022.json
==================================================

å¼€å§‹è¿è¡Œæ¸¸æˆ...

è¿è¡Œæ¸¸æˆ 10/10...
âœ… ç»“æœå·²ä¿å­˜åˆ°: evaluation_results_baseline_20250115_143022.json

==================================================
ç‹¼äººæ€æ¸¸æˆè¯„ä¼°æŠ¥å‘Š
==================================================

ğŸ“Š åŸºæœ¬ç»Ÿè®¡
  æ€»å±€æ•°: 10
  å¹³å‡è½®æ•°: 4.2

ğŸ† èƒœç‡ç»Ÿè®¡
  æ‘æ°‘é˜µè¥èƒœç‡: 60.0% (6/10)
  ç‹¼äººé˜µè¥èƒœç‡: 40.0% (4/10)

ğŸ‘¥ è§’è‰²ç»Ÿè®¡
  æ‘æ°‘:
    èƒœç‡: 60.0%
    å­˜æ´»ç‡: 45.0%
  ç‹¼äºº:
    èƒœç‡: 40.0%
    å­˜æ´»ç‡: 25.0%
  ...

==================================================
```

### 2. å¼€å‘è‡ªå®šä¹‰ Agent

å‚è€ƒ `examples/agent_werewolves/enhanced_agent.py` åˆ›å»ºä½ çš„è‡ªå®šä¹‰ Agentã€‚

å…³é”®è¦æ±‚ï¼š
```python
# ä½ çš„ Agent æ¨¡å—å¿…é¡»åŒ…å« agent_factory å‡½æ•°
async def agent_factory(role: str) -> ReActAgent:
    """åˆ›å»ºè‡ªå®šä¹‰ Agentã€‚
    
    Args:
        role: è§’è‰²ç±»å‹ (villager, werewolf, seer, witch, hunter)
        
    Returns:
        ç¬¦åˆè¦æ±‚çš„ Agent å®ä¾‹
    """
    # å®ç°ä»£ç 
    pass
```

### 3. è¿è¡Œè‡ªå®šä¹‰ Agent æµ‹è¯•

```bash
python evaluate.py --num-games 10 --mode custom \
  --custom-agent ../../agent_werewolves/enhanced_agent.py
```

### 4. å¯¹æ¯”ç»“æœ

æ¯”è¾ƒä¸¤æ¬¡è¿è¡Œçš„ç»“æœæ–‡ä»¶ï¼ˆbaseline å’Œ customï¼‰ï¼š

- æŸ¥çœ‹èƒœç‡æå‡
- åˆ†æè§’è‰²è¡¨ç°
- è¯„ä¼°ç­–ç•¥æœ‰æ•ˆæ€§

## ğŸ”§ å‘½ä»¤è¡Œå‚æ•°

### åŸºæœ¬å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--num-games` | è¿è¡Œçš„æ¸¸æˆå±€æ•° | 10 |
| `--mode` | è¯„ä¼°æ¨¡å¼ï¼š`baseline` æˆ– `custom` | baseline |
| `--custom-agent` | è‡ªå®šä¹‰ Agent æ¨¡å—è·¯å¾„ | - |
| `--output` | è¾“å‡ºæŠ¥å‘Šè·¯å¾„ | evaluation_results_<mode>_<timestamp>.json |
| `--no-progress` | ä¸æ˜¾ç¤ºè¿›åº¦ä¿¡æ¯ | False |

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1ï¼šå¿«é€Ÿæµ‹è¯•ï¼ˆ3 å±€ï¼‰

```bash
python evaluate.py --num-games 3 --mode custom \
  --custom-agent ../../agent_werewolves/my_agent.py
```

#### ç¤ºä¾‹ 2ï¼šå¤§è§„æ¨¡è¯„ä¼°ï¼ˆ100 å±€ï¼‰

```bash
python evaluate.py --num-games 100 --mode custom \
  --custom-agent ../../agent_werewolves/my_agent.py \
  --output my_agent_100games.json
```

#### ç¤ºä¾‹ 3ï¼šæ— è¿›åº¦è¾“å‡ºï¼ˆé€‚åˆåå°è¿è¡Œï¼‰

```bash
python evaluate.py --num-games 50 --mode custom \
  --custom-agent ../../agent_werewolves/my_agent.py \
  --no-progress > output.log 2>&1 &
```

## ğŸ“Š è¯„ä¼°æŒ‡æ ‡è¯´æ˜

### 1. åŸºæœ¬ç»Ÿè®¡

- **æ€»å±€æ•°**: æˆåŠŸè¿è¡Œçš„æ¸¸æˆå±€æ•°
- **å¤±è´¥å±€æ•°**: å› å¼‚å¸¸è€Œå¤±è´¥çš„æ¸¸æˆå±€æ•°
- **å¹³å‡è½®æ•°**: æ¸¸æˆå¹³å‡æŒç»­è½®æ•°

### 2. èƒœç‡ç»Ÿè®¡

- **æ‘æ°‘é˜µè¥èƒœç‡**: æ‘æ°‘æ–¹è·èƒœçš„æ¯”ä¾‹
- **ç‹¼äººé˜µè¥èƒœç‡**: ç‹¼äººæ–¹è·èƒœçš„æ¯”ä¾‹

**æ³¨æ„**: ä¸¤ä¸ªé˜µè¥çš„èƒœç‡ä¹‹å’Œåº”ä¸º 100%

### 3. è§’è‰²ç»Ÿè®¡

æ¯ä¸ªè§’è‰²çš„è¯¦ç»†ç»Ÿè®¡ï¼š

- **èƒœç‡**: è¯¥è§’è‰²æ‰€åœ¨é˜µè¥è·èƒœçš„æ¯”ä¾‹
- **å­˜æ´»ç‡**: è¯¥è§’è‰²åœ¨æ¸¸æˆç»“æŸæ—¶ä»å­˜æ´»çš„æ¯”ä¾‹

### 4. å¯¹æ¯”åˆ†æ

å½“ä½ è¿è¡ŒåŸºçº¿å’Œè‡ªå®šä¹‰ Agent åï¼Œå¯ä»¥å¯¹æ¯”ï¼š

- **èƒœç‡æå‡**: è‡ªå®šä¹‰ Agent ç›¸å¯¹åŸºçº¿çš„èƒœç‡å˜åŒ–
- **ç­–ç•¥æœ‰æ•ˆæ€§**: åˆ¤æ–­æ”¹è¿›æ˜¯å¦æœ‰æ•ˆ
- **ç»Ÿè®¡æ˜¾è‘—æ€§**: æ ·æœ¬é‡è¶Šå¤§ï¼Œç»“æœè¶Šå¯é 

**å»ºè®®æ ·æœ¬é‡**ï¼š
- åˆæ­¥éªŒè¯ï¼š10-20 å±€
- å¯é è¯„ä¼°ï¼š50-100 å±€
- å……åˆ†éªŒè¯ï¼š200+ å±€

## ğŸ“ è¾“å‡ºæ–‡ä»¶æ ¼å¼

è¯„ä¼°ç³»ç»Ÿä¼šç”Ÿæˆ JSON æ ¼å¼çš„ç»“æœæ–‡ä»¶ï¼š

```json
[
  {
    "game_id": 1,
    "winner": "villagers",
    "total_rounds": 5,
    "players": [
      {
        "name": "å¼ ä¼Ÿ",
        "role": "werewolf",
        "survived": false,
        "rounds_survived": 3
      },
      ...
    ],
    "timestamp": "2025-01-15T14:30:22.123456",
    "failed": false,
    "error_message": null
  },
  ...
]
```

### å­—æ®µè¯´æ˜

- `game_id`: æ¸¸æˆç¼–å·
- `winner`: èƒœåˆ©æ–¹ï¼ˆ"werewolves" æˆ– "villagers"ï¼‰
- `total_rounds`: æ¸¸æˆæ€»è½®æ•°
- `players`: ç©å®¶ä¿¡æ¯åˆ—è¡¨
  - `name`: ç©å®¶å§“å
  - `role`: è§’è‰²ï¼ˆvillager/werewolf/seer/witch/hunterï¼‰
  - `survived`: æ˜¯å¦å­˜æ´»
  - `rounds_survived`: å­˜æ´»è½®æ•°
- `failed`: æ¸¸æˆæ˜¯å¦å¤±è´¥
- `error_message`: é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰

## ğŸ§ª æµ‹è¯•éªŒè¯

### éªŒè¯æ¸¸æˆé€»è¾‘é‡æ„

é‡æ„åï¼ŒåŸæœ‰æ¸¸æˆè¿è¡Œæ–¹å¼åº”ä¿æŒä¸å˜ï¼š

```bash
# æµ‹è¯•å•å±€æ¸¸æˆ
python main.py
```

åº”è¯¥èƒ½æ­£å¸¸è¿è¡Œä¸€å±€å®Œæ•´çš„ç‹¼äººæ€æ¸¸æˆã€‚

### éªŒè¯è¯„ä¼°ç³»ç»Ÿ

```bash
# 1. æµ‹è¯•åŸºçº¿æ¨¡å¼
python evaluate.py --num-games 3 --mode baseline

# 2. æµ‹è¯•è‡ªå®šä¹‰ Agent æ¨¡å¼
python evaluate.py --num-games 3 --mode custom \
  --custom-agent ../../agent_werewolves/enhanced_agent.py

# 3. æ£€æŸ¥è¾“å‡ºæ–‡ä»¶
cat evaluation_results_*.json | head -20
```

### å¸¸è§é—®é¢˜æ’æŸ¥

#### é—®é¢˜ 1ï¼šæ¨¡å—åŠ è½½å¤±è´¥

```
âŒ åŠ è½½è‡ªå®šä¹‰ Agent å¤±è´¥: Agent æ¨¡å—æ–‡ä»¶ä¸å­˜åœ¨
```

**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ã€‚

#### é—®é¢˜ 2ï¼šç¼ºå°‘ agent_factory å‡½æ•°

```
âŒ åŠ è½½è‡ªå®šä¹‰ Agent å¤±è´¥: æ¨¡å—ä¸­æœªæ‰¾åˆ° 'agent_factory' å‡½æ•°
```

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿æ¨¡å—ä¸­å®šä¹‰äº† `async def agent_factory(role: str) -> ReActAgent` å‡½æ•°ã€‚

#### é—®é¢˜ 3ï¼šæ¸¸æˆè¿è¡Œå¤±è´¥

```
âš ï¸  è­¦å‘Š: 3 å±€æ¸¸æˆè¿è¡Œå¤±è´¥
```

**è§£å†³æ–¹æ¡ˆ**: 
- æ£€æŸ¥ API é…ç½®æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹è¾“å‡ºæ–‡ä»¶ä¸­çš„ `error_message` å­—æ®µ
- ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸

#### é—®é¢˜ 4ï¼šè¿›åº¦å¡ä½

**è§£å†³æ–¹æ¡ˆ**:
- æ¸¸æˆå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ˆæ¯å±€ 5-10 åˆ†é’Ÿï¼‰
- ä½¿ç”¨ `--no-progress` å‚æ•°å¹¶æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
- å‡å°‘ `--num-games` æ•°é‡è¿›è¡Œæµ‹è¯•

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. è¿­ä»£å¼€å‘æµç¨‹

```
1. å¿«é€ŸéªŒè¯ï¼ˆ3-5 å±€ï¼‰
   â””â”€> è°ƒè¯• Agent é€»è¾‘
2. å°è§„æ¨¡æµ‹è¯•ï¼ˆ10-20 å±€ï¼‰
   â””â”€> åˆæ­¥è¯„ä¼°æ•ˆæœ
3. ä¸­ç­‰è§„æ¨¡ï¼ˆ50 å±€ï¼‰
   â””â”€> ç¡®è®¤ç­–ç•¥æœ‰æ•ˆæ€§
4. å¤§è§„æ¨¡éªŒè¯ï¼ˆ100+ å±€ï¼‰
   â””â”€> å……åˆ†éªŒè¯ç¨³å®šæ€§
```

### 2. å¯¹æ¯”æµ‹è¯•

```bash
# Step 1: è¿è¡ŒåŸºçº¿
python evaluate.py --num-games 50 --mode baseline \
  --output baseline_50.json

# Step 2: è¿è¡Œè‡ªå®šä¹‰ Agent v1
python evaluate.py --num-games 50 --mode custom \
  --custom-agent my_agent_v1.py \
  --output custom_v1_50.json

# Step 3: æ”¹è¿›ç­–ç•¥åè¿è¡Œ v2
python evaluate.py --num-games 50 --mode custom \
  --custom-agent my_agent_v2.py \
  --output custom_v2_50.json

# Step 4: å¯¹æ¯”ä¸‰æ¬¡ç»“æœ
# æ‰‹åŠ¨æŸ¥çœ‹ä¸‰ä¸ª JSON æ–‡ä»¶çš„ç»Ÿè®¡æ•°æ®
```

### 3. æ€§èƒ½ä¼˜åŒ–å»ºè®®

- **å‡å°‘æ¨¡å‹è°ƒç”¨**: ä¼˜åŒ– Agent é€»è¾‘ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¨ç†
- **æ‰¹é‡è¿è¡Œ**: ä½¿ç”¨ `--num-games` ä¸€æ¬¡æ€§è¿è¡Œæ‰€éœ€å±€æ•°
- **åå°è¿è¡Œ**: å¤§è§„æ¨¡è¯„ä¼°ä½¿ç”¨åå°è¿è¡Œï¼Œé¿å…ä¸­æ–­

### 4. ç»“æœåˆ†ææŠ€å·§

- **æŸ¥çœ‹èƒœç‡å˜åŒ–**: è‡ªå®šä¹‰ Agent èƒœç‡æ˜¯å¦æå‡
- **åˆ†æè§’è‰²è¡¨ç°**: ç‰¹å®šè§’è‰²çš„æ”¹è¿›æ•ˆæœ
- **å…³æ³¨å­˜æ´»ç‡**: å…³é”®è§’è‰²ï¼ˆé¢„è¨€å®¶ã€å¥³å·«ï¼‰çš„å­˜æ´»ç‡
- **æ¸¸æˆè½®æ•°**: æ›´çŸ­çš„æ¸¸æˆå¯èƒ½æ„å‘³ç€æ›´é«˜æ•ˆçš„ç­–ç•¥

## ğŸ“š å‚è€ƒèµ„æº

- ç¤ºä¾‹ Agent: `examples/agent_werewolves/enhanced_agent.py`
- Agent å¼€å‘æŒ‡å—: `examples/agent_werewolves/README.md`
- æ¸¸æˆä¸»é€»è¾‘: `examples/game/werewolves/main.py`
- è¯„ä¼°æ¡†æ¶æºç : `examples/game/werewolves/evaluation/`

## ğŸ¤ æ¯”èµ›æäº¤

å‡†å¤‡æ¯”èµ›æäº¤æ—¶ï¼š

1. ç¡®ä¿ä½ çš„ Agent ç¬¦åˆæ‰€æœ‰è¦æ±‚
2. è¿è¡Œå……åˆ†çš„è¯„ä¼°æµ‹è¯•ï¼ˆå»ºè®® 100+ å±€ï¼‰
3. è®°å½•ä½ çš„ç­–ç•¥æ”¹è¿›å’Œæ•ˆæœ
4. å‡†å¤‡å±•ç¤ºä½ çš„è¯„ä¼°ç»“æœ

ç¥ä½ åœ¨æ¯”èµ›ä¸­å–å¾—å¥½æˆç»©ï¼ğŸ†

